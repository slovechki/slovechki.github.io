<html>
<title>Генератор игр</title>

<head>
    <script>
        const words = ['АВСТРАЛИЯ', 'АВТОБУС', 'АВТОМОБИЛЬ', 'ГОСУДАРСТВО', 'ЯСТРЕБ', 'АКВАЛАНГИСТ', 'РОЛЬ', 'АТЛАНТИДА', 'АЛМАЗ', 'АМЕРИКА', 'АНГЛИЯ', 'АПЕЛЬСИН', 'АНТАРКТИДА', 'АФРИКА', 'ВЕДЬМА', 'БАЗА', 'ФРУКТЫ', 'БАНК', 'ЧЕРВЬ', 'БАССЕЙН', 'БАШНЯ', 'БИТЬ', 'КАНАДА', 'ПОБЕРЕЖЬЕ', 'ШАГ', 'СУПЕРГЕРОЙ', 'БРАЗИЛИЯ', 'БУТЫЛКА', 'РАССКАЗ', 'МУЗЫКА', 'ВАКУУМ', 'ВАРЕНЬЕ', 'РАЗЪЁМ', 'КИТ', 'ВЕРТОЛЕТ', 'ВЕТЕР', 'ВЕТЕРИНАР', 'ЧИСТЫЙ', 'ВИНО', 'ВОЗДУХ', 'АМАЗОНКА', 'ВОЛНА', 'ЛЕТУЧАЯ МЫШЬ', 'ВОСТОК', 'ВЫСТАВКА', 'ВЫСТРЕЛ', 'ГАРАЖ', 'ГЕРМАНИЯ', 'ГИТАРА', 'ГЛАЗ', 'ГОЛОВА', 'УТЕС', 'ОШИБКА', 'ОТЕЛЬ', 'ГРОБОВЩИК', 'КАРЛИК', 'ГРУДЬ', 'ГРУППА', 'КОРОЛЬ', 'СОЛОМА', 'ДВЕРЬ', 'ДВИГАТЕЛЬ', 'ИНДЕЙКА', 'ДЕНЬ', 'РЕБЕНОК', 'ДИНОЗАВР', 'ДОЛИНА', 'ПРЕСС', 'КЕНТАВР', 'ЕВРОПА', 'ЕГИПЕТ', 'ФЕНИКС', 'ЖЕЛЕЗО', 'ЗАБОР', 'НАЗАД', 'ЗАЛИВ', 'ЗАМОК', 'ЗАРЯЖАТЬ', 'ЗВЕЗДА', 'ЗВУК', 'СЛОНОВАЯ КОСТЬ', 'ЗИМА', 'ДРАКОН', 'ЗОЛОТО', 'НИНДЗЯ', 'ЗУБ', 'БУЙВОЛ', 'ИГРАТЬ', 'ИНОПЛАНЕТЯНИН', 'ИНДИЯ', 'ИСТОРИЯ', 'ГИМАЛАИ', 'КАЗИНО', 'МРАМОР', 'ФЕРМА', 'КАПОТ', 'КАРТА', 'ЗЕРКАЛО', 'ОРЕХ', 'КАЧЕЛИ', 'КВАДРАТ', 'КЕНГУРУ', 'КЕТЧУП', 'КИРПИЧ', 'ВЕРБЛЮД', 'КИТАЙ', 'КЛУБ', 'КНИГА', 'ЯЙЦО', 'КОД', 'КОЛЕСО', 'КОЛЬЦО', 'КОНЦЕРТ', 'АЛКОГОЛЬ', 'СУДНО', 'КОРЕНЬ', 'КОРОЛЕВА', 'КОРОНА', 'МЕДСЕСТРА', 'КОТ', 'КОФЕ', 'КРАН', 'КРЕМ', 'КРИКЕТ', 'КРОВЬ', 'ПИНГВИН', 'ПЕРЕСЕКАТЬ', 'КРУГ', 'ХОБОТ', 'КРЫША', 'КРОВАТЬ', 'ЛАБОРАТОРИЯ', 'ЛАПА', 'АНГЕЛ', 'ЛЁД', 'ЛЕС', 'ЛИМОН', 'ЛИМУЗИН', 'ЛОДКА', 'ЛОНДОН', 'ЛОШАДЬ', 'ЛУК', 'ЛУНА', 'ЛУЧ', 'СКОЛЬЖЕНИЕ', 'ЛЮБЛЮ', 'МАГАЗИН', 'ЯГОДА', 'МАМОНТ', 'МАСЛО', 'ШКАЛА', 'КРОЛИК', 'МЁД', 'МЕДВЕДЬ', 'МЕТАЛЛ', 'МИЛЛИОНЕР', 'МОДЕЛЬ', 'МОЛОКО', 'ПОДКОВА', 'МОРЕ', 'МОРОЖЕННОЕ', 'МОСКВА', 'МОСТ', 'ГОЛЛИВУД', 'ФУНТ', 'МЯЧ', 'НЕБО', 'НЕБОСКРЁБ', 'РУКА', 'НОЖ', 'НЬЮ-ЙОРК', 'ОБЛАКО', 'ОГОНЬ', 'ОПЕРА', 'ОРЁЛ', 'ОТПУСК', 'ПАЛЕЦ', 'ПАЛЬМА', 'ПАУК', 'ПАРАШЮТ', 'ПАРК', 'РАКЕТКА', 'ПЕКИН', 'ПЕРСОНАЛ', 'ПЫЛЬ', 'ПЕЧАТЬ', 'ПИАНИНО', 'БАР', 'ПИВО', 'ПИЛОТ', 'ПИРАТ', 'ПИСТОЛЕТ', 'ЗАМЕТКА', 'ПИЦЦА', 'ПЛАСТИК', 'ПЛАСТИНА', 'ПЛЯЖ', 'ПИСЬМО', 'ПОВАР', 'ПОДЛОДКА', 'ПОЕЗД', 'ПОЕЗДКА', 'ПОКЛОННИК', 'ГАЛСТУК', 'ПОРТ', 'ПОЧТА', 'ТОКИО', 'ОСЕНЬ', 'ПРОКАТ', 'ПУЛЯ', 'КОРА', 'ШЕКСПИР', 'РАКЕТА', 'РЕВОЛЮЦИЯ', 'РЕКА', 'ГИГАНТ', 'РОМАН', 'РОТ', 'ДОЛЛАР', 'РУЛЕТКА', 'ПИРАМИДА', 'БЛОК', 'КРУЖКА', 'ВЕТЧИНА', 'САМОЛЁТ', 'САТУРН', 'БЕРМУДСКИЕ ОСТРОВА', 'ГВОЗДЬ', 'УТКОНОС', 'СЕВЕР', 'СЕЙФ', 'ОСЬМИНОГ', 'СЕРЕБРО', 'СЕТЬ', 'ПОСОЛЬСТВО', 'СИЛА', 'ФЛЕЙТА', 'АЦТЕК', 'СТРОКА', 'СНЕГ', 'СНЕГОВИК', 'СОБАКА', 'СОЛДАТ', 'МЕРКУРИЙ', 'МЕЧТА', 'КАСТРЮЛЯ', 'БЕРЛИН', 'СПУТНИК', 'СТЕНА', 'МОЛЬ', 'СКАМЬЯ', 'ЧАСТНЫЙ', 'СЮЖЕТ', 'ТАНЕЦ', 'ТЕАТР', 'АГЕНТ', 'ТЕЛЕСКОП', 'ИДЕЯ', 'ЛЕВ', 'ТОРТ', 'ТРАВА', 'ТРУБА', 'СКОРПИОН', 'МЕКСИКА', 'АЛЬПЫ', 'УТКА', 'ФИЛЬМ', 'ФРАНЦИЯ', 'ФУТБОЛ', 'МОРКОВЬ', 'ХВОСТ', 'ХЛЕБ', 'ШАЙБА', 'ТУБА', 'ПРИНЦЕССА', 'РЫЦАРЬ', 'ЦВЕТОК', 'ЦЕНА', 'ЦЕНТР', 'ЦЫПЛЁНОК', 'ЧАЙ', 'ЧАСЫ', 'ЧЕШСКИЙ', 'ЗАКЛИНАНИЕ', 'ШКОЛА', 'ШОКОЛАД', 'ПИРОГ', 'ЭКРАН', 'ЭЛЕКТРИЧЕСКИЙ', 'ЮГ', 'ЮПИТЕР', 'ЯБЛОКО', 'ЯД', 'КЛЁН', 'ОБЛОЖКА', 'ПЛАТЬЕ', 'ГЕНИЙ', 'КУРТКА', 'ЛИНИЯ', 'БОЕЦ', 'КЕПКА', 'СМЕРТЬ', 'СКОРАЯ ПОМОЩЬ', 'ЗАБОЛЕВАЕМОСТЬ', 'БОЛЕЗНЬ', 'ВРАЧ', 'БОЛЬНИЦА', 'ГРИПП', 'ТАБЛЕТКА', 'ТИК', 'ДОСКА', 'АККУМУЛЯТОР', 'ПАДЕНИЕ', 'ОТМЕТКА', 'ВЕРЁВКА', 'СЛЕД', 'ГОРН', 'СОЕДИНЕНИЕ', 'ДРЕЛЬ', 'ФУТ', 'КРЮК', 'ЛАЗЕР', 'МАССА', 'МИКРОСКОП', 'ШАХТА', 'КРЕПЛЕНИЕ', 'ЧАСТЬ', 'ШТЫРЬ', 'СТОЛБ', 'ПЕРЕКЛЮЧАТЕЛЬ', 'ФАКЕЛ', 'ТРУБКА', 'ОЛИВКОВЫЙ', 'ЕДИНОРОГ', 'РАЗБУДИТЬ', 'МАРШ', 'ИЗМЕНЕНИЕ', 'ДАТА', 'НОЧЬ', 'ВЕСНА', 'ВРЕМЯ', 'ЛЕТАТЬ', 'ПРОХОДИТЬ', 'ТОЧКА', 'КОЛОКОЛ', 'СЧЕТ', 'СВЯЗЬ', 'БУМ', 'БОТИНОК', 'КОРОБКА', 'ПЕРЕРЫВ', 'СВЕЧА', 'СТУЛ', 'ПРОВЕРЯТЬ', 'ЦЕРКОВЬ', 'ХОЛОД', 'УГОЛ', 'ХЛОПОК', 'СУД', 'СТЕПЕНЬ', 'ИГРА В КОСТИ', 'ФИГУРА', 'ИГРА', 'БЛАГОДАТЬ', 'ЗЕЛЕНЬ', 'ДЫРА', 'ПОЦЕЛУЙ', 'АДВОКАТ', 'ЖИЗНЬ', 'СВЕТ', 'МУСОР', 'ЖУРНАЛ', 'УДАЧА', 'МЭР', 'ИГЛА', 'БРЮКИ', 'ВЫБИРАТЬ', 'УЧЕНИК', 'КРУГЛЫЙ', 'РЯД', 'ПАРУС', 'УЧЁНЫЙ', 'ОБУВЬ', 'УЛЫБКА', 'НОСОК', 'АКЦИИ', 'КОСТЮМ', 'УЧИТЕЛЬ', 'ХРАМ', 'ДВОР', 'РЕМЕНЬ', 'БОМБА', 'КНОПКА', 'КЛЕТКА', 'КОНТРАКТ', 'ФАЙЛ', 'ССЫЛКА', 'СОВПАДЕНИЕ', 'ВСТАВИТЬ', 'СЕРВЕР', 'КОНТРАБАНДИСТ', 'ШПИОН', 'БИРКА', 'ВОР', 'ВОЙНА', 'ПОЗВОНОЧНИК', 'БОЛЬШОЙ ПАЛЕЦ', 'СВИНЕЦ', 'МЯТА', 'ПОТОК', 'ТЕЛЁНОК', 'МАЛИНОВКА', 'АМСТЕРДАМ', 'ПТИЦА', 'ДРУЖОК', 'МОЗГ', 'ЩЕТКА', 'БАБОЧКА', 'ДЕЛО', 'ШАНС', 'КУРИЦА', 'КОМПЬЮТЕР', 'КРОКОДИЛ', 'ТЕКУЩИЙ', 'БЛЮДО', 'ЗЕМЛЯ', 'ПРИМЕР', 'ПОЛЕ', 'РЫБА', 'ФОКУС', 'ДРУГ', 'САД', 'ЖИРАФ', 'ОХРАНА', 'СЕРДЦЕ', 'ТЕПЛО', 'НАДЕЯТЬСЯ', 'КЛЮЧ', 'КИВИ', 'КРЕМЛЬ', 'ОЗЕРО', 'ЗАКОН', 'ЛЕОПАРД', 'БИБЛИОТЕКА', 'МАРС', 'ДЕНЬГИ', 'ОБЕЗЬЯНА', 'МЫШЬ', 'СТРАНИЦА', 'ПОКРАСИТЬ', 'ПАНДА', 'БУМАГА', 'ПАРИЖ', 'КАРТИНА', 'ИГРОК', 'НАСТОЯЩЕЕ ВРЕМЯ', 'ПРЕЗИДЕНТ', 'ПРИНЦИП', 'ПРОБЛЕМА', 'РАДИО', 'ДОЖДЬ', 'РИСК', 'ДОРОГА', 'СКАЛА', 'САХАРА', 'СОЛЬ', 'ВТОРОЙ', 'АКУЛА', 'ПОКАЗАТЬ', 'ЗМЕЯ', 'ПОЧВЫ', 'ПРОСТРАНСТВО', 'ИСПАНИЯ', 'СКОРОСТЬ', 'ДУХ', 'МЕСТО', 'СТАНДАРТ', 'СТУДЕНТ', 'САХАР', 'ЛЕТО', 'СОЛНЦЕ', 'СИСТЕМА', 'ТАБЛИЦА', 'ТЕХАС', 'ДЕРЕВО', 'ОВОЩНОЙ', 'ВОДЫ', 'ПОГОДА', 'ЗАПАДНЫЙ', 'КРЫЛО', 'ГОД', 'ЗЕБРА'];

        const gameSpots = [
            'red', 'red', 'red', 'red', 'red', 'red', 'red', 'red', 'red',
            'blue', 'blue', 'blue', 'blue', 'blue', 'blue', 'blue', 'blue',
            'brown', 'brown', 'brown', 'brown', 'brown', 'brown', 'brown', 'black'];

        const gamesToLookBack = 12;
        const gamesToGenerate = 100;

        function shuffle(initialArray) {
            let array = initialArray.slice(0);
            let counter = array.length;

            while (counter > 0) {
                let index = Math.floor(Math.random() * counter);
                counter--;
                let temp = array[counter];
                array[counter] = array[index];
                array[index] = temp;
            }
            return array;
        }

        function generateGames() {
            let allGames = [];
            for (let gameIndex = 0; gameIndex < gamesToGenerate; gameIndex++) {
                let firstTeam = (gameIndex + 1) % 2 === 0 ? 'blue' : 'red';
                gameSpots[0] = firstTeam;
                let shuffledGameSpots = shuffle(gameSpots);
                let shuffledWords = shuffle(words);
                allGames.push([]);

                for (let gameSpotIndex = 0; gameSpotIndex < gameSpots.length; gameSpotIndex++) {
                    let colour = shuffledGameSpots[gameSpotIndex];
                    let word = getUniqueWord(allGames, gameIndex, shuffledWords, gameSpotIndex);
                    allGames[gameIndex].push([colour, word]);
                }
            }

            let gamesAsJson = JSON.stringify(allGames);
            let gamesDisplayContainer = document.getElementById('games');
            gamesDisplayContainer.value = gamesAsJson;
        }

        function getUniqueWord(games, currentGameIndex, words, currentWordIndex) {
            if (currentGameIndex === 0) return words[currentWordIndex];

            const firstGameToCheck = Math.max(currentGameIndex - gamesToLookBack, 0);

            for (let wordIndex = currentWordIndex; wordIndex < words.length; wordIndex++) {
                let currentWord = words[wordIndex];
                if (isWordUsedInPreviousGames(currentWord, games, firstGameToCheck, currentGameIndex)) {
                    continue;
                }
                return currentWord;
            }
        }

        function isWordUsedInPreviousGames(word, games, startGameIndex, currentGameIndex) {
            for (let gameIndex = startGameIndex; gameIndex <= currentGameIndex; gameIndex++) {
                let wordIndexInGame = games[gameIndex].findIndex((wordColourPair) => wordColourPair[1] === word);
                if (wordIndexInGame > -1) return true;
            }
            return false;
        }

        function testWordUniqueness() {
            const gamesText = document.getElementById('games').value;
            const games = JSON.parse(gamesText);

            for (let gameIndex = 0; gameIndex < (gamesToGenerate - gamesToLookBack); gameIndex++) {
                let blockOfGamesRequiredToBeUnique = games.slice(gameIndex, gameIndex + gamesToLookBack);                
                if (nonUniqueWordsInBlock(blockOfGamesRequiredToBeUnique)) {
                    console.log('Слова повторяются в ', blockOfGamesRequiredToBeUnique);
                    alert('Слова повторяются');
                    break;
                }
            }
            alert('Все слова уникальны');
        }

        function nonUniqueWordsInBlock(gamesBlock) {
            const words = new Set();
            for (let game of gamesBlock) {
                for (let element of game) {
                    let word = element[1];
                    if (words.has(word)) {
                        console.log(`Слово ${word} уже существует в`, words);
                        return true;
                    }
                    words.add(word);
                }
            }
            return false;
        }
    </script>
</head>

<body>
    <button onclick="generateGames()">Генерировать игры</button> <button onclick="testWordUniqueness()">Проверить слова
        на уникальность</button><br>
    <textarea id="games" rows=20 cols=100></textarea>
</body>

</html>